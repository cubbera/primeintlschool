<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Add Student & Create Tuition Plan</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f3f4f6;
        padding: 30px;
    }

    .container {
        max-width: 860px;
        margin: auto;
        background: #fff;
        padding: 28px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    h1 {
        margin-top: 0;
        margin-bottom: 10px;
    }

    h2 {
        margin-top: 28px;
        border-bottom: 2px solid #e5e7eb;
        padding-bottom: 6px;
        font-size: 18px;
    }

    label {
        display: block;
        font-weight: bold;
        margin-top: 12px;
        margin-bottom: 4px;
    }

    input, select {
        width: 100%;
        padding: 10px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        margin-bottom: 6px;
        font-size: 14px;
        box-sizing: border-box;
    }

    .two-col {
        display: flex;
        gap: 16px;
    }

    .two-col > div {
        flex: 1;
    }

    .discount-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 8px;
        padding: 8px 10px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        background: #f9fafb;
    }

    .discount-row select {
        width: 68%;
        margin-bottom: 0;
    }

    .discount-amount {
        font-weight: bold;
        color: red;
        text-align: right;
        width: 30%;
        font-variant-numeric: tabular-nums;
    }

    table {
        width: 100%;
        margin-top: 16px;
        border-collapse: collapse;
    }

    table td {
        padding: 6px 4px;
        font-size: 14px;
    }

    table td:nth-child(2) {
        text-align: right;
        font-weight: bold;
        font-variant-numeric: tabular-nums;
        white-space: nowrap;
    }

    .btn-add {
        margin-top: 10px;
        background: #1d4ed8;
        color: #fff;
        padding: 8px 16px;
        border-radius: 6px;
        border: none;
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
    }

    .btn-add:hover {
        background: #1e40af;
    }

    .btn-submit {
        margin-top: 22px;
        width: 100%;
        background: #059669;
        color: #fff;
        font-size: 18px;
        padding: 14px;
        border-radius: 8px;
        cursor: pointer;
        border: none;
        font-weight: bold;
    }

    .btn-submit:hover {
        background: #047857;
    }

    .note {
        font-size: 12px;
        color: #6b7280;
        margin-top: 4px;
    }
</style>

<script>
function autoFillTuition() {
    const division = document.getElementById("division").value;
    const level = document.getElementById("level").value;
    const plan = document.getElementById("paymentPlan").value;
    const tuitionInput = document.getElementById("tuitionBefore");

    if (!division || !level || !plan) {
        return;
    }

    // Determine group: Preschool or Primary
    let group;
    if (division === "Preschool" || ["SR","EY1","EY2"].includes(level)) {
        group = "Preschool";
    } else {
        group = "Primary";
    }

    let amount = 0;
    if (group === "Preschool") {
        if (plan === "Annual") amount = 3900000;
        else if (plan === "Termly") amount = 4200000;
        else if (plan === "Monthly") amount = 4200000;
    } else { // Primary
        if (plan === "Annual") amount = 4200000;
        else if (plan === "Termly") amount = 4500000;
        else if (plan === "Monthly") amount = 4500000;
    }

    tuitionInput.value = amount;
    updateDiscounts();
}

function addDiscountRow() {
    const container = document.getElementById("discountContainer");

    const row = document.createElement("div");
    row.className = "discount-row";

    row.innerHTML = `
        <select onchange="updateDiscounts()">
            <option value="">-- Select Discount --</option>
            <option value="early35">Early Bird 35%</option>
            <option value="play15">Play &amp; Learn 15%</option>
            <option value="ref100">Referral -100,000 MMK</option>
            <option value="sib5">Sibling 5%</option>
            <option value="sib10">Sibling 10%</option>
        </select>
        <div class="discount-amount">0</div>
    `;

    container.appendChild(row);
    updateDiscounts();
}

function updateDiscounts() {
    const tuition = parseInt(document.getElementById("tuitionBefore").value || 0, 10);
    const discountRows = document.querySelectorAll("#discountContainer .discount-row");
    let totalDiscount = 0;

    discountRows.forEach(row => {
        const select = row.querySelector("select");
        const value = select.value;
        const amountBox = row.querySelector(".discount-amount");
        let amount = 0;

        if (!value || tuition <= 0) {
            amountBox.textContent = "0";
            return;
        }

        switch (value) {
            case "early35":
                amount = tuition * 0.35;
                break;
            case "play15":
                amount = tuition * 0.15;
                break;
            case "ref100":
                amount = 100000;
                break;
            case "sib5":
                amount = tuition * 0.05;
                break;
            case "sib10":
                amount = tuition * 0.10;
                break;
        }

        amount = Math.round(amount);
        amountBox.textContent = "-" + amount.toLocaleString();
        totalDiscount += amount;
    });

    const totalDiscountCell = document.getElementById("totalDiscount");
    const afterDiscountCell = document.getElementById("afterDiscount");
    const monthlyFeeCell = document.getElementById("monthlyFee");

    totalDiscountCell.textContent = "-" + totalDiscount.toLocaleString();

    const net = tuition - totalDiscount;
    afterDiscountCell.textContent = net.toLocaleString();

    // Monthly fee based on 10 installments (for quick reference)
    const monthly = net > 0 ? Math.round(net / 10) : 0;
    monthlyFeeCell.textContent = monthly.toLocaleString();
}

window.onload = function() {
    // Initialize discount calculations based on default tuition
    updateDiscounts();
};
</script>

</head>
<body>

<div class="container">

    <h1>Add New Student</h1>

    <!-- SECTION 1 — STUDENT INFO -->
    <h2>1. Student Information</h2>

    <label>Full Name</label>
    <input type="text" placeholder="e.g. Aye Aye">

    <label>Father's Name</label>
    <input type="text" placeholder="e.g. U Kyaw Win">

    <div class="two-col">
        <div>
            <label>Gender</label>
            <select>
                <option value="">Select gender</option>
                <option>Male</option>
                <option>Female</option>
            </select>
        </div>
        <div>
            <label>Date of Birth</label>
            <input type="date">
        </div>
    </div>

    <!-- SECTION 2 — ENROLLMENT -->
    <h2>2. Enrollment</h2>

    <label>Academic Year</label>
    <select>
        <option>2025–2026</option>
    </select>

    <div class="two-col">
        <div>
            <label>Division</label>
            <select id="division" onchange="autoFillTuition()">
                <option value="">Select division</option>
                <option value="Preschool">Preschool</option>
                <option value="Primary">Primary</option>
            </select>
        </div>
        <div>
            <label>Level</label>
            <select id="level" onchange="autoFillTuition()">
                <option value="">Select level</option>
                <option value="SR">SR</option>
                <option value="EY1">EY1</option>
                <option value="EY2">EY2</option>
                <option value="Y1">Y1</option>
                <option value="Y2">Y2</option>
                <option value="Y3">Y3</option>
            </select>
        </div>
    </div>

    <label>Payment Plan</label>
    <select id="paymentPlan" onchange="autoFillTuition()">
        <option value="">Select plan</option>
        <option value="Monthly">Monthly</option>
        <option value="Termly">Termly</option>
        <option value="Annual">Annual</option>
    </select>
    <div class="note">
        Tuition will be auto-filled based on Division + Level + Payment Plan.
    </div>

    <!-- SECTION 3 — TUITION CALC -->
    <h2>3. Calculated Tuition Summary</h2>

    <label>Tuition Before Discount</label>
    <input type="number" id="tuitionBefore" value="4200000" onkeyup="updateDiscounts()">

    <h3>Add Discounts</h3>
    <div class="note">Choose one or more discounts. Amounts will be calculated automatically.</div>
    <div id="discountContainer"></div>
    <button type="button" class="btn-add" onclick="addDiscountRow()">+ Add Discount</button>

    <table>
        <tr>
            <td>Total Discount</td>
            <td id="totalDiscount">0</td>
        </tr>
        <tr>
            <td>After Discount</td>
            <td id="afterDiscount">4,200,000</td>
        </tr>
        <tr>
            <td>Monthly Fee (10 installments)</td>
            <td id="monthlyFee">420,000</td>
        </tr>
    </table>

    <button class="btn-submit">Add Student &amp; Create Tuition Plan</button>

</div>

</body>
</html>
