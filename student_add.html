<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Tuition Plan</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, system-ui;
  background:#f5f5f7;
  padding:40px;
}

.container {
  max-width:1000px;
  margin:auto;
  background:#fff;
  padding:30px;
  border-radius:12px;
}

h2 {
  margin-top:30px;
  border-bottom:1px solid #ddd;
  padding-bottom:6px;
}

.row {
  display:flex;
  align-items:center;
  gap:16px;
  margin-top:14px;
}

.label {
  width:260px;
  font-weight:600;
}

input, select {
  padding:8px 10px;
  font-size:14px;
  width:220px;
}

.radio-row {
  display:flex;
  gap:40px;
  margin-top:12px;
}

.discount-table {
  margin-top:16px;
}

.discount-header,
.discount-row {
  display:grid;
  grid-template-columns: 90px 200px 220px 180px 200px 40px;
  gap:10px;
  align-items:center;
}

.discount-header {
  font-weight:700;
  margin-bottom:8px;
}

.discount-row {
  margin-top:8px;
  color:#b91c1c;
}

.discount-amount {
  text-align:right;
  font-weight:600;
}

.remove-btn {
  cursor:pointer;
  font-size:18px;
  color:#b91c1c;
  text-align:center;
}

.add-discount-btn {
  margin-top:14px;
  padding:10px 14px;
  background:#e5e7eb;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

.final-btn {
  margin-top:28px;
  padding:16px;
  width:100%;
  font-size:16px;
  background:#059669;
  color:white;
  border:none;
  border-radius:8px;
}

.total {
  margin-top:12px;
  font-weight:700;
}

.total.red {
  color:#b91c1c;
}
</style>
</head>

<body>
<div class="container">

<h2>1. Enrollment</h2>

<div class="row">
  <div class="label">Academic Year:</div>
  <select id="academicYear" onchange="updateStudentId()">
    <option value="">Select</option>
    <option value="AY25">AY2025–2026</option>
    <option value="SUM26">Summer 2026</option>
    <option value="AY26">AY2026–2027</option>
  </select>
</div>

<div class="radio-row">
  <label><input type="radio" checked> New Student</label>
  <label><input type="radio"> Current Student</label>
</div>

<div class="row">
  <div class="label">Student ID:</div>
  <input id="studentId" readonly>
</div>

<h2>2. Calculating Payment</h2>

<div class="row">
  <div class="label">Tuition Before Discount:</div>
  <div><b id="baseAmount">10,000,000</b></div>
</div>

<div class="discount-table">
  <div class="discount-header">
    <div>Disc #</div>
    <div>Type</div>
    <div>Amount</div>
    <div>Discount</div>
    <div>After Discount</div>
    <div></div>
  </div>

  <div id="discountBody"></div>
</div>

<button class="add-discount-btn" onclick="addDiscount()">+ Add Discount</button>

<div class="total red">Total Discount: <span id="totalDiscount">0</span></div>
<div class="total">Amount After Discount: <span id="afterDiscount">10,000,000</span></div>
<div class="total">Monthly Fee (10x): <span id="monthlyFee">1,000,000</span></div>

<button class="final-btn">Add Student & Create Payment Plan</button>

</div>

<script>
const BASE = 10000000;
let discounts = [];

function updateStudentId() {
  const y = academicYear.value;
  studentId.value = y === "AY25" ? "PR25142" :
                    (y === "SUM26" || y === "AY26") ? "PR26012" : "";
}

function addDiscount() {
  discounts.push({ type:"fixed", value:0 });
  render();
}

function removeDiscount(i) {
  discounts.splice(i,1);
  render();
}

function render() {
  const body = document.getElementById("discountBody");
  body.innerHTML = "";

  // FIXED FIRST
  const fixed = discounts.filter(d=>d.type==="fixed");
  const percent = discounts.filter(d=>d.type==="percent");
  const ordered = [...fixed, ...percent];

  let running = BASE;
  let totalDisc = 0;

  ordered.forEach((d,i)=>{
    let disc = d.type==="fixed" ? d.value : Math.round(running * d.value/100);
    running -= disc;
    totalDisc += disc;

    body.innerHTML += `
      <div class="discount-row">
        <div>Disc #${i+1}</div>
        <select onchange="updateType(${i},this.value)">
          <option value="fixed" ${d.type==="fixed"?"selected":""}>Fixed Amount</option>
          <option value="percent" ${d.type==="percent"?"selected":""}>Percentage</option>
        </select>
        <input type="number" value="${d.value}" oninput="updateValue(${i},this.value)">
        <div class="discount-amount">-${disc.toLocaleString()}</div>
        <div>${running.toLocaleString()}</div>
        <div class="remove-btn" onclick="removeDiscount(${i})">−</div>
      </div>
    `;
  });

  totalDiscount.textContent = "-" + totalDisc.toLocaleString();
  afterDiscount.textContent = running.toLocaleString();
  monthlyFee.textContent = Math.round(running/10).toLocaleString();
}

function updateType(i,v){ discounts[i].type=v; render(); }
function updateValue(i,v){ discounts[i].value=Number(v||0); render(); }

render();
</script>
</body>
</html>
