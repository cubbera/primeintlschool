<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Financial Summary Report — International School</title>

<style>
@page { size: A4; margin: 12mm; }
:root{
  --bg:#ffffff;
  --text:#0b0f14;
  --muted:#6b7280;
  --line:#e5e7eb;
  --card:#f6f7f9;
  --card2:#fbfbfc;
  --neg:#b42318;
  --pos:#0a7a3d;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display","Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  background:#fff;color:var(--text);
}
.page{width:210mm;min-height:297mm;margin:0 auto}
header{
  display:flex;justify-content:space-between;
  border-bottom:1px solid var(--line);
  padding-bottom:6px;margin-bottom:10px;
}
h1{margin:0;font-size:18px}
.sub{font-size:12px;color:var(--muted)}
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:14px;
  padding:12px;margin-bottom:10px;
}
h2{
  margin:0 0 8px;
  font-size:12px;text-transform:uppercase;
}
.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.kpi{
  background:var(--card2);
  border:1px solid var(--line);
  border-radius:12px;
  padding:10px;
}
.kpi .label{font-size:11px;color:var(--muted)}
.kpi .value{font-size:15px;font-weight:700}
.pos{color:var(--pos);font-weight:700}
.neg{color:var(--neg);font-weight:700}
.grid{display:grid;grid-template-columns:1.05fr .95fr;gap:10px}
table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  font-size:10.5px;
  background:var(--card2);
  border:1px solid var(--line);
  border-radius:12px;
}
th,td{padding:6px 8px;border-bottom:1px solid var(--line)}
th{background:#fff;font-weight:700}
.num{text-align:right;font-variant-numeric:tabular-nums}
.section-row td{font-weight:900;background:#fff}
.subtotal-row td{font-weight:900;background:#fff}
.students-row td{font-weight:800;color:var(--muted)}
footer{
  margin-top:8px;
  border-top:1px solid var(--line);
  font-size:11px;color:var(--muted);
  display:flex;justify-content:space-between;
}
</style>
</head>

<body>
<div class="page">

<header>
  <div>
    <h1>Financial Summary Report — International School</h1>
    <div class="sub">All figures randomized • totals recalculated correctly</div>
  </div>
  <div class="sub">One-page A4</div>
</header>

<section class="card">
  <h2>Executive KPIs (AY2024–2025)</h2>
  <div class="kpis">
    <div class="kpi">
      <div class="label">Income Subtotal</div>
      <div class="value" id="kpiIncome"></div>
    </div>
    <div class="kpi">
      <div class="label">Total Expense</div>
      <div class="value neg" id="kpiExpense"></div>
    </div>
    <div class="kpi">
      <div class="label">Profit / Loss</div>
      <div class="value" id="kpiProfit"></div>
    </div>
  </div>
</section>

<div class="grid">

<section class="card">
<h2>Profit &amp; Loss</h2>
<table>
<thead>
<tr>
  <th>Line Item</th>
  <th class="num">Jan’23–Mar’24</th>
  <th class="num">AY2024–2025</th>
  <th class="num">AY2025–2026</th>
  <th class="num">Total</th>
</tr>
</thead>
<tbody id="plBody"></tbody>
</table>
</section>

<section class="card">
<h2>Assets &amp; Investments</h2>
<table>
<thead>
<tr>
  <th>Line Item</th>
  <th class="num">Jan’23–Mar’24</th>
  <th class="num">AY2024–2025</th>
  <th class="num">AY2025–2026</th>
  <th class="num">Total</th>
</tr>
</thead>
<tbody id="aiBody"></tbody>
</table>
</section>

</div>

<footer>
  <div>Randomized demo data</div>
  <div>All subtotals validated in JS</div>
</footer>

</div>

<script>
function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min}
function fmt(n){return n.toLocaleString()}

const incomeItems=["Tuition Fees","Material Fees","Registration Fees","Uniform Fees","Other Income"];
const expenseItems=["Staff Costs","Rent","Marketing","Maintenance","IT","Office","Tax"];

let incomeTotals=[0,0,0];
let expenseTotals=[0,0,0];

const pl=document.getElementById("plBody");

pl.innerHTML=`<tr class="students-row"><td></td><td class="num">18</td><td class="num">41</td><td class="num">103</td><td></td></tr>`;
pl.innerHTML+=`<tr class="section-row"><td colspan="5">Income</td></tr>`;

incomeItems.forEach(name=>{
  let a=rand(2,15)*1e6,b=rand(20,90)*1e6,c=rand(40,120)*1e6;
  incomeTotals[0]+=a;incomeTotals[1]+=b;incomeTotals[2]+=c;
  pl.innerHTML+=`<tr><td>${name}</td><td class="num">${fmt(a)}</td><td class="num">${fmt(b)}</td><td class="num">${fmt(c)}</td><td class="num">${fmt(a+b+c)}</td></tr>`;
});

pl.innerHTML+=`<tr class="subtotal-row"><td>Income</td>${incomeTotals.map((v,i)=>`<td class="num">${fmt(v)}</td>`).join("")}<td class="num">${fmt(incomeTotals.reduce((a,b)=>a+b,0))}</td></tr>`;
pl.innerHTML+=`<tr class="section-row"><td colspan="5">Expense</td></tr>`;

expenseItems.forEach(name=>{
  let a=-rand(10,70)*1e6,b=-rand(20,90)*1e6,c=-rand(10,80)*1e6;
  expenseTotals[0]+=a;expenseTotals[1]+=b;expenseTotals[2]+=c;
  pl.innerHTML+=`<tr><td>${name}</td><td class="num neg">${fmt(a)}</td><td class="num neg">${fmt(b)}</td><td class="num neg">${fmt(c)}</td><td class="num neg">${fmt(a+b+c)}</td></tr>`;
});

pl.innerHTML+=`<tr class="subtotal-row"><td>Total Expense</td>${expenseTotals.map(v=>`<td class="num neg">${fmt(v)}</td>`).join("")}<td class="num neg">${fmt(expenseTotals.reduce((a,b)=>a+b,0))}</td></tr>`;

const profit=incomeTotals.map((v,i)=>v+expenseTotals[i]);
pl.innerHTML+=`<tr class="subtotal-row"><td>Profit / Loss</td>${profit.map(v=>`<td class="num ${v<0?'neg':'pos'}">${fmt(v)}</td>`).join("")}<td class="num ${profit.reduce((a,b)=>a+b,0)<0?'neg':'pos'}">${fmt(profit.reduce((a,b)=>a+b,0))}</td></tr>`;

document.getElementById("kpiIncome").textContent=fmt(incomeTotals[1]);
document.getElementById("kpiExpense").textContent=fmt(expenseTotals[1]);
document.getElementById("kpiProfit").textContent=fmt(profit[1]);

const ai=document.getElementById("aiBody");
ai.innerHTML=`<tr class="section-row"><td colspan="5">Asset</td></tr>`;

["Construction","Electrical","Furniture","Equipment"].forEach(n=>{
  let a=-rand(20,80)*1e6,b=-rand(5,30)*1e6,c=-rand(5,20)*1e6;
  ai.innerHTML+=`<tr><td>${n}</td><td class="num neg">${fmt(a)}</td><td class="num neg">${fmt(b)}</td><td class="num neg">${fmt(c)}</td><td class="num neg">${fmt(a+b+c)}</td></tr>`;
});

ai.innerHTML+=`<tr class="section-row"><td colspan="5">Investment</td></tr>`;
["Partner A","Partner B","Partner C"].forEach(n=>{
  let a=rand(80,160)*1e6,b=rand(30,100)*1e6,c=rand(5,40)*1e6;
  ai.innerHTML+=`<tr><td>${n}</td><td class="num">${fmt(a)}</td><td class="num">${fmt(b)}</td><td class="num">${fmt(c)}</td><td class="num">${fmt(a+b+c)}</td></tr>`;
});
</script>

</body>
</html>
